{"version":3,"file":null,"sources":["../src/index.js"],"sourcesContent":["// @flow\n\nexport default class Scrolload {\n    constructor(options) {\n        let ops = $.extend(true, {\n            page: 1,\n            count: 10,\n            tpl: function(item) {\n                return `\n                    <div class=\"item\">item ${item}</div>\n                `;\n            },\n        }, options);\n        this.page = ops.page;\n        this.count = ops.count;\n        this.data = ops.data;\n        this.totalPage = Math.ceil(this.data.length / this.count);\n        this.$container = $(ops.container);\n        this.tpl = ops.tpl;\n        this.isLoading = false;\n\n        this.render().onScroll();\n    }\n    render() {\n        let data,\n            tpl,\n            start = (this.page - 1) * this.count,\n            end = this.page * this.count,\n            total = this.data.length;\n        end = end > total ? total : end;\n        data = this.data.slice(start, end);\n        tpl = this.template(data);\n        this.append(tpl);\n        return this;\n    }\n    template(data) {\n        let tpl = '',\n            htmls = [];\n            console.log(this);\n        data.map((item) => {\n            tpl = this.tpl(item);\n            htmls.push(tpl);\n            tpl = ``;\n        });\n        return htmls.join('');\n    }\n    append(tpl) {\n        $(tpl).appendTo(this.$container);\n        this.page ++;\n        this.isLoading = false;\n    }\n    onScroll() {\n        $(window).on('scroll', () => {\n            let bodyHeight = $('body').height(),\n                winHeight = $(window).height(),\n                scrollTop = $(window).scrollTop(),\n                thresold = bodyHeight - winHeight - scrollTop;\n            console.log(thresold);\n            if(thresold < 20 && !this.isLoading) {\n                this.isLoading = true;\n                console.log('is loading ...');\n                if(this.totalPage >= this.page) {\n                    setTimeout(() => {\n                        this.render();\n                        console.log('loaded.');\n                    }, 500);\n                } else {\n                    console.log('no more data.');\n                }\n            }\n        });\n    }\n}\n"],"names":[],"mappings":"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"}