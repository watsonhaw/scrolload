{"version":3,"file":null,"sources":["../src/index.js"],"sourcesContent":["// @flow\n\nexport default class Scrolload {\n    constructor(options) {\n        let ops = $.extend(true, {\n            page: 1,\n            count: 10,\n            tpl: function(item) {\n                return `\n                    <div class=\"item\">item ${item}</div>\n                `;\n            },\n        }, options);\n        this.page = ops.page;\n        this.count = ops.count;\n        this.data = ops.data;\n        this.totalPage = Math.ceil(this.data.length / this.count);\n        this.$container = $(ops.container);\n        this.tpl = ops.tpl;\n        this.isLoading = false;\n\n        this.render().onScroll();\n    }\n    render() {\n        let data,\n            tpl,\n            start = (this.page - 1) * this.count,\n            end = this.page * this.count,\n            total = this.data.length;\n        end = end > total ? total : end;\n        data = this.data.slice(start, end);\n        tpl = this.template(data);\n        this.append(tpl);\n        return this;\n    }\n    template(data) {\n        let tpl = '',\n            htmls = [];\n            console.log(this);\n        data.map((item) => {\n            tpl = this.tpl(item);\n            htmls.push(tpl);\n            tpl = ``;\n        });\n        return htmls.join('');\n    }\n    append(tpl) {\n        $(tpl).appendTo(this.$container);\n        this.page ++;\n        this.isLoading = false;\n    }\n    onScroll() {\n        $(window).on('scroll', () => {\n            let bodyHeight = $('body').height(),\n                winHeight = $(window).height(),\n                scrollTop = $(window).scrollTop(),\n                thresold = bodyHeight - winHeight - scrollTop;\n            console.log(thresold);\n            if(thresold < 20 && !this.isLoading) {\n                this.isLoading = true;\n                console.log('is loading ...');\n                if(this.totalPage >= this.page) {\n                    setTimeout(() => {\n                        this.render();\n                        console.log('loaded.');\n                    }, 500);\n                } else {\n                    console.log('no more data.');\n                }\n            }\n        });\n    }\n}\n"],"names":["Scrolload","options","ops","$","extend","item","page","count","data","totalPage","Math","ceil","this","length","$container","container","tpl","isLoading","render","onScroll","start","end","total","slice","template","append","htmls","log","map","_this","push","join","appendTo","window","on","bodyHeight","height","winHeight","scrollTop","thresold","_this2"],"mappings":"yhBAEqBA,wBACLC,gBACJC,GAAMC,EAAEC,QAAO,QACT,QACC,OACF,SAASC,yDAEmBA,+BAGlCJ,QACEK,KAAOJ,EAAII,UACXC,MAAQL,EAAIK,WACZC,KAAON,EAAIM,UACXC,UAAYC,KAAKC,KAAKC,KAAKJ,KAAKK,OAASD,KAAKL,YAC9CO,WAAaX,EAAED,EAAIa,gBACnBC,IAAMd,EAAIc,SACVC,WAAY,OAEZC,SAASC,yDAGVX,UACAQ,SACAI,GAASR,KAAKN,KAAO,GAAKM,KAAKL,MAC/Bc,EAAMT,KAAKN,KAAOM,KAAKL,MACvBe,EAAQV,KAAKJ,KAAKK,gBAChBQ,EAAMC,EAAQA,EAAQD,IACrBT,KAAKJ,KAAKe,MAAMH,EAAOC,KACxBT,KAAKY,SAAShB,QACfiB,OAAOT,GACLJ,sCAEFJ,cACDQ,EAAM,GACNU,oBACQC,IAAIf,QACXgB,IAAI,SAACvB,KACAwB,EAAKb,IAAIX,KACTyB,KAAKd,UAGRU,EAAMK,KAAK,mCAEff,KACDA,GAAKgB,SAASpB,KAAKE,iBAChBR,YACAW,WAAY,kDAGfgB,QAAQC,GAAG,SAAU,cACfC,GAAahC,EAAE,QAAQiC,SACvBC,EAAYlC,EAAE8B,QAAQG,SACtBE,EAAYnC,EAAE8B,QAAQK,YACtBC,EAAWJ,EAAaE,EAAYC,UAChCX,IAAIY,GACTA,EAAW,KAAOC,EAAKvB,cACjBA,WAAY,UACTU,IAAI,kBACTa,EAAK/B,WAAa+B,EAAKlC,gBACX,aACFY,iBACGS,IAAI,YACb,aAEKA,IAAI"}